<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0" />
    <meta name="theme-color" content="#101010" />
    <title>Markets · BLKPVNTHR</title>

    <link rel="stylesheet" href="styles.css?v=4" />

    <style>
      .page-wrap { max-width:1300px; margin:18px auto; padding:0 14px 40px; }
      .panel { background:var(--card); border:1px solid var(--border); border-radius:14px; padding:14px; }

      .pairs-grid { display:grid; gap:18px; }
      .pair-row { display:grid; grid-template-columns:1fr 1fr; gap:14px; }
      @media (max-width:950px){ .pair-row{ grid-template-columns:1fr; } }

      .tv-card{ background:rgba(0,0,0,.2); border:1px solid rgba(255,255,255,.08); border-radius:12px; padding:10px; }
      .tv-title{ display:flex; justify-content:space-between; margin-bottom:8px; font-size:13px; }
      .chart-box{ height:360px; }

      .chiprow{ display:flex; gap:8px; flex-wrap:wrap; margin-top:10px; }
      .chip{ border:1px solid rgba(255,255,255,.12); border-radius:999px; padding:6px 10px; font-size:12px; background:rgba(255,255,255,.04); }

      .long{ color:#6ee7b7; }
      .inverse{ color:#fca5a5; }

      /* ===== Top toggle view ===== */
      .top-view { margin-bottom: 14px; }

      .strip {
        display:flex;
        gap:10px;
        overflow-x:auto;
        padding:10px 4px;
        scrollbar-width:thin;
      }
      .strip::-webkit-scrollbar { height: 8px; }
      .strip::-webkit-scrollbar-thumb { background: rgba(255,255,255,.12); border-radius: 999px; }

      .pill{
        display:inline-flex;
        align-items:center;
        gap:10px;
        border:1px solid rgba(255,255,255,.12);
        background:rgba(255,255,255,.04);
        border-radius:999px;
        padding:8px 12px;
        cursor:pointer;
        user-select:none;
        white-space:nowrap;
      }
      .pill.active{
        border-color: rgba(125, 211, 252, 0.45);
        background: rgba(125, 211, 252, 0.12);
      }
      .pill .dot{
        width:10px;height:10px;border-radius:999px;
        background:rgba(255,255,255,.30);
      }
      .pill.long .dot{ background:rgba(110,231,183,.90); }
      .pill.inverse .dot{ background:rgba(252,165,165,.90); }

      .pill .name{ font-weight:800; font-size:12.5px; letter-spacing:.2px; }
      .pill .meta{ font-size:12px; color:var(--muted); }

      .main-chart-card{
        background: rgba(0,0,0,.2);
        border: 1px solid rgba(255,255,255,.08);
        border-radius: 12px;
        padding: 10px;
      }
      .main-chart-title{
        display:flex;
        justify-content:space-between;
        align-items:baseline;
        gap:10px;
        margin-bottom:8px;
        font-size:13px;
      }
      .main-chart-box{ height:520px; }
      @media (max-width: 950px) { .main-chart-box { height: 420px; } }
    </style>
  </head>

  <body class="locked">
    <!-- LOGIN -->
    <div id="authOverlay" class="overlay">
      <div class="auth-card">
        <h1>BLKPVNTHR</h1>

        <input id="email" type="email" placeholder="email" />
        <button id="sendLinkBtn" class="btn primary">Send magic link</button>

        <div class="divider"></div>

        <input id="pin" type="password" placeholder="PIN" />
        <button id="unlockBtn" class="btn ghost">Unlock</button>

        <p id="authMsg"></p>
      </div>
    </div>

    <div id="navbar-placeholder"></div>

    <!-- APP -->
    <div id="app" class="page-wrap hidden">
      <header style="margin-bottom:14px">
        <h1 style="margin:0">Markets</h1>
        <p class="muted">Index Futures vs Leveraged Inverse ETFs</p>

        <div class="chiprow">
          <span class="chip long">Futures = Risk ON</span>
          <span class="chip inverse">Inverse ETF = Risk OFF</span>
        </div>
      </header>

      <main class="panel">
        <!-- TOP TOGGLE VIEW -->
        <section class="top-view">
          <div class="main-chart-card">
            <div class="main-chart-title">
              <strong id="mainTitle" class="long">NYA — NYSE Composite (Market Breadth)</strong>
              <span class="tiny muted" id="mainSubtitle">Click a pill to switch charts</span>
            </div>

            <div id="tv_main" class="main-chart-box"></div>

            <div class="strip" id="chartStrip" aria-label="Markets chart switcher"></div>
          </div>
        </section>

        <div class="pairs-grid">
          <!-- S&P -->
          <div class="pair-row">
            <div class="tv-card">
              <div class="tv-title"><strong class="long">AAPL — Apple Inc.</strong></div>
              <div id="tv_aapl" class="chart-box"></div>
            </div>

            <div class="tv-card">
              <div class="tv-title"><strong class="inverse">SPXU — 3× Inverse S&P 500</strong></div>
              <div id="tv_spxu" class="chart-box"></div>
            </div>
          </div>

          <!-- NASDAQ -->
          <div class="pair-row">
            <div class="tv-card">
              <div class="tv-title"><strong class="long">NQ1! — E-mini Nasdaq</strong></div>
              <div id="tv_nq" class="chart-box"></div>
            </div>

            <div class="tv-card">
              <div class="tv-title"><strong class="inverse">SQQQ — 3× Inverse Nasdaq</strong></div>
              <div id="tv_sqqq" class="chart-box"></div>
            </div>
          </div>

                    <!-- DOW -->
          <div class="pair-row">
            <div class="tv-card">
              <div class="tv-title"><strong class="long">YM1! — E-mini Dow</strong></div>
              <div id="tv_ym" class="chart-box"></div>
            </div>

            <div class="tv-card">
              <div class="tv-title"><strong class="long">RTY1! — E-mini Russell</strong></div>
              <div id="tv_rty" class="chart-box"></div>
            </div>
          </div>
            
      </main>
    </div>

    <!-- NAVBAR -->
    <script>
      (async ()=>{
        const res = await fetch("navbar.html");
        document.getElementById("navbar-placeholder").innerHTML = await res.text();
      })();
    </script>

    <!-- TradingView -->
    <script src="https://s3.tradingview.com/tv.js"></script>

    <!-- Supabase -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script>
      window.sb = supabase.createClient(
        "https://xtespuzbuepublmiciyf.supabase.co",
        "sb_publishable_giqkrVUBnF8PS-7sWS_WaQ_2lk-8wOL"
      );
    </script>

    <script src="app.js"></script>

    <!-- Charts -->
    <script>
      (function () {
        function chart(containerId, symbol, interval = "5", range = "1D") {
          const el = document.getElementById(containerId);
          if (el) el.innerHTML = "";

          new TradingView.widget({
            autosize: true,
            symbol,
            interval,
            timezone: "America/New_York",
            theme: "dark",
            style: "1",
            locale: "en",
            withdateranges: true,
            range,
            enable_publishing: false,
            hide_top_toolbar: false,
            hide_legend: false,
            save_image: false,
            studies: ["Volume@tv-basicstudies"],
            container_id: containerId
          });
        }

        // NOTE:
        // NYSE:NYA typically does NOT support intraday intervals in embeds.
        // So we force DAILY ("D") to avoid the "Only D,W,M intervals" message.
        const ITEMS = [
          { key: "nya",  label: "NYA",  desc: "NYSE Composite (Market Breadth)", symbol: "NYSE:NYA",        kind: "long",    interval: "D", range: "6m" },

          { key: "aapl", label: "AAPL", desc: "Apple Inc.",                      symbol: "NASDAQ:AAPL",    kind: "long",    interval: "5", range: "1D" },
          { key: "spxu", label: "SPXU", desc: "3× Inverse S&P 500",              symbol: "AMEX:SPXU",      kind: "inverse", interval: "5", range: "1D" },

          { key: "nq",   label: "NQ1!", desc: "E-mini Nasdaq",                   symbol: "CME_MINI:NQ1!",  kind: "long",    interval: "5", range: "1D" },
          { key: "sqqq", label: "SQQQ", desc: "3× Inverse Nasdaq",               symbol: "NASDAQ:SQQQ",    kind: "inverse", interval: "5", range: "1D" },

          { key: "ym",   label: "YM1!", desc: "E-mini Dow",                      symbol: "CBOT_MINI:YM1!", kind: "long",    interval: "5", range: "1D" },
          { key: "rty",  label: "RTY1!", desc: "E-mini Russell",                 symbol: "CME_MINI:RTY1!", kind: "long",    interval: "5", range: "1D" }
        ];

        function setMainActive(key) {
          const item = ITEMS.find(x => x.key === key) || ITEMS[0];

          const title = document.getElementById("mainTitle");
          const sub = document.getElementById("mainSubtitle");

          if (title) {
            title.classList.remove("long","inverse");
            title.classList.add(item.kind);
            title.textContent = `${item.label} — ${item.desc}`;
          }
          if (sub) sub.textContent = `${item.symbol} · interval ${item.interval}`;

          chart("tv_main", item.symbol, item.interval, item.range);

          document.querySelectorAll("#chartStrip .pill").forEach(p => {
            p.classList.toggle("active", p.dataset.key === item.key);
          });
        }

        function buildStrip() {
          const strip = document.getElementById("chartStrip");
          if (!strip) return;

          strip.innerHTML = ITEMS.map(item => `
            <button class="pill ${item.kind}" type="button" data-key="${item.key}">
              <span class="dot" aria-hidden="true"></span>
              <span class="name">${item.label}</span>
              <span class="meta">${item.desc}</span>
            </button>
          `).join("");

          strip.addEventListener("click", (e) => {
            const btn = e.target.closest(".pill");
            if (!btn) return;
            setMainActive(btn.dataset.key);
          });
        }

        function initPairs() {
          // ✅ FIX: tv_aapl (not tv_appl)
          chart("tv_aapl", "NASDAQ:AAPL", "5", "1D");
          chart("tv_spxu", "AMEX:SPXU", "5", "1D");

          chart("tv_nq", "CME_MINI:NQ1!", "5", "1D");
          chart("tv_sqqq", "NASDAQ:SQQQ", "5", "1D");

          chart("tv_ym", "CBOT_MINI:YM1!", "5", "1D");

          chart("tv_rty", "CME_MINI:RTY1!", "5", "1D");
        }

        buildStrip();
        setMainActive("nya");   // ✅ Large chart = NYSE (Daily)
        initPairs();
      })();
    </script>
  </body>
  <footer class="bg-black w-100">
  <div class="container-fluid py-5 d-flex flex-column justify-content-center align-items-center">

    <!-- divider -->
    <div class="footer-divider mb-4"></div>

    <!-- centered text -->
    <div class="footer-text">
      © <span id="year">2026</span> BLKPVNTHR — All rights reserved.
    </div>

  </div>
</footer>
</html>